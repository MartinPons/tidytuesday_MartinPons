scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL,
title = "Grow index of threats") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6))
threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL,
title = "Grow index of threats") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
g_bars <- threats %>%
filter(threatened == 1) %>%
count(threat_type) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ggplot(aes(n, fct_reorder(threat_type, n))) +
geom_col(aes(fill = threat_grouped), show.legend = F, width = .7) +
geom_vline(xintercept = seq(0, 250, by = 50), color = background_color) +
geom_text(aes(label = threat_type), hjust = 0, x = 3, family = text_family, color = text_color) +
labs(x = NULL, y = NULL,
title = "Threats responsible for plants extinction") +
scale_fill_manual(values = fill_palette) +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
axis.ticks.y = element_blank(),
panel.background = element_rect(fill = background_color, color = background_color),
plot.background = element_rect(fill = background_color, color = background_color),
panel.grid = element_blank(),
axis.text.y = element_blank(),
plot.background = element_rect(fill = background_color))
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL,
title = "Grow index of threats") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6))
g_bars <- threats %>%
filter(threatened == 1) %>%
count(threat_type) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ggplot(aes(n, fct_reorder(threat_type, n))) +
geom_col(aes(fill = threat_grouped), show.legend = F, width = .7) +
geom_vline(xintercept = seq(0, 250, by = 50), color = background_color) +
geom_text(aes(label = threat_type), hjust = 0, x = 3, family = text_family, color = text_color) +
labs(x = NULL, y = NULL,
title = "Threats responsible for plants extinction") +
scale_fill_manual(values = fill_palette) +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
axis.ticks.y = element_blank(),
panel.background = element_rect(fill = background_color, color = background_color),
plot.background = element_rect(fill = background_color, color = background_color),
panel.grid = element_blank(),
axis.text.y = element_blank())
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL,
title = "Grow index of threats") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6))
?grid.arrange
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change have being grown in importance as an existential threats
to plants")
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change have being grown in importance as an existential threats
to plants", gp=gpar(fill = background_color, lwd=1, family = text_family))
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL, y = "Growth index (Before 1900 = 1)"
title = "Variation in the number of threats since 1900") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL, y = "Growth index (Before 1900 = 1)",
title = "Variation in the number of threats since 1900") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change have being grown in importance as an existential threats
to plants", gp=gpar(fill = background_color, lwd=1, family = text_family))
g_bars <- threats %>%
filter(threatened == 1) %>%
count(threat_type) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ggplot(aes(n, fct_reorder(threat_type, n))) +
geom_col(aes(fill = threat_grouped), show.legend = F, width = .7) +
geom_vline(xintercept = seq(0, 250, by = 50), color = background_color) +
geom_text(aes(label = threat_type), hjust = 0, x = 3, family = text_family, color = text_color) +
labs(x = NULL, y = NULL,
title = "Threats associated to plants extinctions") +
scale_fill_manual(values = fill_palette) +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
axis.ticks.y = element_blank(),
panel.background = element_rect(fill = background_color, color = background_color),
plot.background = element_rect(fill = background_color, color = background_color),
panel.grid = element_blank(),
axis.text.y = element_blank())
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL, y = "Growth index (Before 1900 = 1)",
title = "Variation in the number of threats since 1900") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change have being grown in importance as an existential threats
to plants", gp=gpar(fill = background_color, lwd=1, family = text_family))
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped, color = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL, y = "Growth index (Before 1900 = 1)",
title = "Variation in the number of threats since 1900") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change have being grown in importance as an existential threats
to plants", gp=gpar(fill = background_color, lwd=1, family = text_family))
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped, color = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL, y = "Growth index (Before 1900 = 1)",
title = "Variation in the number of threats since 1900") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change has being grown in importance as an existential threats
to plants", gp=gpar(fill = background_color, lwd=1, family = text_family))
g_bars <- threats %>%
filter(threatened == 1) %>%
count(threat_type) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ggplot(aes(n, fct_reorder(threat_type, n))) +
geom_col(aes(fill = threat_grouped), show.legend = F, width = .7) +
geom_vline(xintercept = seq(0, 250, by = 50), color = background_color) +
geom_text(aes(label = threat_type), hjust = 0, x = 3, family = text_family, color = text_color) +
labs(x = NULL, y = NULL,
title = "Threats linked to extintion of plant species in the planet") +
scale_fill_manual(values = fill_palette) +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
axis.ticks.y = element_blank(),
panel.background = element_rect(fill = background_color, color = background_color),
plot.background = element_rect(fill = background_color, color = background_color),
panel.grid = element_blank(),
axis.text.y = element_blank())
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped, color = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL, y = "Growth index (Before 1900 = 1)",
title = "Variation in the number of threats since 1900") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
g_bars <- threats %>%
filter(threatened == 1) %>%
count(threat_type) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ggplot(aes(n, fct_reorder(threat_type, n))) +
geom_col(aes(fill = threat_grouped), show.legend = F, width = .7) +
geom_vline(xintercept = seq(0, 250, by = 50), color = background_color) +
geom_text(aes(label = threat_type), hjust = 0, x = 3, family = text_family, color = text_color) +
labs(x = NULL, y = NULL,
title = "Threats linked to extintion of plant species in the planet") +
scale_fill_manual(values = fill_palette) +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
axis.ticks.y = element_blank(),
panel.background = element_rect(fill = background_color, color = background_color),
plot.background = element_rect(fill = background_color, color = background_color),
panel.grid = element_blank(),
axis.text.y = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change has being grown in importance as an existential threats
to plants", gp=gpar(fill = background_color, lwd=1, family = text_family))
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change has being grown in importance as an existential threats
to plants species in the lasts decades", gp=gpar(fill = background_color, lwd=1, family = text_family))
library(tidyverse)
library(skimr)
library(tidytext)
library(ggedit)
library(gridExtra)
library(grid)
library(extrafont)
tuesdata <- tidytuesdayR::tt_load('2020-08-18')
plants <- tuesdata$plants
threats <- tuesdata$threats
actions <- tuesdata$actions
plants_longer <- plants %>%
pivot_longer(names_to = "threat", values_to = "threat_exists", matches("threat"),
names_prefix = "threat_") %>%
filter(threat_exists == 1) %>%
select(-threat_exists)
ordered_periods <- c("Before 1900" , "1900-1919", "1920-1939" ,
"1940-1959", "1960-1979", "1980-1999",
"2000-2020")
threats <- threats %>%
mutate(year_last_seen = fct_relevel(year_last_seen, ordered_periods))
plants <- plants %>%
mutate(year_last_seen = fct_relevel(year_last_seen, ordered_periods))
background_color <-  "#AAC6AA"
fill_palette <- c("#AA3939", "#CD6666", "grey60")
text_color <- "#014401"
text_family <- "Skranji"
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped, color = threat_grouped),
size = 4.5, shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL, y = "Growth index (Before 1900 = 1)",
title = "Variation in the number of threats since 1900") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change has being grown in importance as an existential threats
to plants species in the lasts decades", gp=gpar(fill = background_color, lwd=1,
family = text_family))
g_bars <- threats %>%
filter(threatened == 1) %>%
count(threat_type) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ggplot(aes(n, fct_reorder(threat_type, n))) +
geom_col(aes(fill = threat_grouped), show.legend = F, width = .7) +
geom_vline(xintercept = seq(0, 250, by = 50), color = background_color) +
geom_text(aes(label = threat_type), hjust = 0, x = 3, family = text_family, color = text_color) +
labs(x = NULL, y = NULL,
title = "Threats linked to extintion of plant species in the planet") +
scale_fill_manual(values = fill_palette) +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
axis.ticks.y = element_blank(),
panel.background = element_rect(fill = background_color, color = background_color),
plot.background = element_rect(fill = background_color, color = background_color),
panel.grid = element_blank(),
axis.text.y = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change has being grown in importance as an existential threats
to plants species in the lasts decades", gp=gpar(fill = background_color, lwd=1,
family = text_family))
g_lines <- threats %>%
filter(threatened == 1, !is.na(year_last_seen)) %>%
count(threat_type, year_last_seen) %>%
mutate(threat_grouped = ifelse(threat_type %in% c("Climate Change", "Geological Events"),
threat_type, "others")) %>%
ungroup() %>%
group_by(threat_type) %>%
mutate(growth_index = n / first(n)) %>%
ggplot(aes(year_last_seen, growth_index)) +
geom_line(aes(color = threat_grouped, group = threat_type, alpha = threat_grouped),
size = 1, show.legend = F) +
geom_point(aes(fill = threat_grouped, alpha = threat_grouped,
color = threat_grouped, size = threat_grouped),
shape = 21, show.legend = F) +
scale_color_manual(values = fill_palette) +
scale_fill_manual(values = fill_palette) +
scale_alpha_manual(values = c(1, 1, 0.6)) +
scale_size_manual(values = c(4.5, 4.5, 2)) +
labs(fill = NULL, color = NULL, alpha = NULL, x = NULL, y = "Growth index (Before 1900 = 1)",
title = "Variation in the number of threats since 1900") +
theme(
text = element_text(color = text_color, family = text_family),
axis.text = element_text(color = text_color),
panel.background = element_rect(fill = background_color, color = background_color),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey85"),
panel.grid.minor.y = element_line(color = "grey85"),
plot.background = element_rect(fill = background_color, color = background_color),
legend.background = element_blank(),
legend.box.background = element_blank())
grid.arrange(grobs = list(g_bars, g_lines), ncol = 2, widths = c(4, 6),
top = "Climate change has being grown in importance as an existential threats
to plants species in the lasts decades", gp=gpar(fill = background_color, lwd=1,
family = text_family))
